<div class="page-content p-3">
    <h6 class="f-8 ls-2 font-weight-bold text-uppercase my-2">upload new video</h6>
    <div class="d-sm-flex d-block mt-4 upload-step">
        <div class="d-sm-block d-flex step-bar mr-sm-4 mb-sm-0 mb-3">
            <span class="f-1 font-weight-bold text-uppercase small-label mr-sm-0 mr-2">steps</span>
            <label
                class="v-center justify-content-center f-4 font-weight-bold ml-sm-1 ml-0 mb-0"
                [class.active]="isActive >= 1"
            >
                1
            </label>
            <div class="line ml-sm-3 ml-0" for="step-2" [class.active]="isActive >= 2"></div>
            <label
                class="v-center justify-content-center f-4 font-weight-bold ml-sm-1 ml-0 mb-0"
                [class.active]="isActive >= 2"
            >
                2
            </label>
            <div class="line ml-sm-3 ml-0" for="step-3" [class.active]="isActive >= 3"></div>
            <label
                class="v-center justify-content-center f-4 font-weight-bold ml-sm-1 ml-0 mb-0"
                [class.active]="isActive >= 3"
            >
                3
            </label>
            <div class="line ml-sm-3 ml-0" for="step-4" [class.active]="isActive == 4"></div>
            <label
                class="v-center justify-content-center f-4 font-weight-bold ml-sm-1 ml-0 mb-0"
                [class.active]="isActive == 4"
            >
                4
            </label>
        </div>
        <div class="step-body-1 ml-sm-5" [class.active]="isStep == 1">
            <span class="f-4 font-weight-bold text-c-dark">Copy and paste web link to the video below</span>
            <div class="web-video my-3">
                <img src="./assets/img/youtube.png">
                <span class="f-4 font-weight-bold text-c-dark mx-2">or</span>
                <img src="./assets/img/vimeo.svg">
            </div>
            <div class="form-group has-feedback mb-4">
                <input class="f-2 form-control" type="text"
                    id="step-1-link" name="video_link"
                    placeholder="eg. https://www.youtube.com/watch?v=dQw4w9WgXcQ"
                    required [(ngModel)]="video.url" #video_link="ngModel"
                    (ngModelChange)="checkVideoUrl()"
                >
            </div>
            <span class="font-weight-bold text-c-dark large-text">or</span>
            <div class="local-video text-center mt-4"
                [ngClass]="{'file-over': fileOver}"
                ng2FileDrop [uploader]="uploader"
                (click)="openFileDialog()"
                (fileOver)="fileDrop($event)"
            >
                <input type="file" style="display: none;" ng2FileSelect [uploader]="uploader" accept=".mp4, .mov"
                    (change)="fileChange($event)" #videoFile />
                <div class="f-4 font-weight-bold text-c-dark my-4">
                    Upload your video
                </div>
                <img src="./assets/img/upload.png">
                <p class="f-1 text-c-dark description mx-auto my-4">Drag and drop your video in the area or click to select it from your local device</p>
            </div>
            <span class="d-flex f-1 text-c-dark mt-3">You can upload only MP4 and MOV file types!</span>
        </div>
        <div class="step-body-2 ml-sm-5" [class.active]="isStep == 2">
            <form 
                #detailForm="ngForm" 
                (ngSubmit)="submitted = true; detailForm.form.valid ? saveDetail() : false"
                [class.was-validated]="submitted"
            >
                <div class="form-group has-feedback mb-4" *ngIf="videoType == 'web'">
                    <label class="f-1 font-weight-bold text-uppercase small-label" for="step-2-link">video link</label>
                    <input class="f-2 form-control" type="text" id="step-2-link" name="video_link"
                        required [(ngModel)]="video.url" #video_link="ngModel"
                    >
                </div>
                <div class="video-default mb-4">
                    <span class="f-1 font-weight-bold text-uppercase small-label" *ngIf="videoType == 'web'">original title</span>
                    <span class="d-flex f-6 font-weight-bold text-c-dark mb-4" *ngIf="videoType == 'web'">{{video.title}}</span>
                    <img [src]="video.thumbnail">
                </div>
                <div class="form-group has-feedback mb-4">
                    <label class="f-1 font-weight-bold text-uppercase small-label" for="title">custom title</label>
                    <input class="f-2 form-control" type="text" id="title" name="video_title"
                        placeholder="Type a title for this video"
                        [(ngModel)]="customTitle" #video_title="ngModel"
                    >
                </div>
                <div class="video-description">
                    <label class="f-1 font-weight-bold text-uppercase small-label">DESCRIPTION</label>
                    <quill-editor
                        image-resize="true"
                        placeholder="Enter Text"
                        [(ngModel)]="video.description"
                        [modules]="config"
                        name="mailContent"
                        [styles]="{ height: '150px' }"
                        #mailContent="ngModel"
                        (onEditorCreated)="getEditorInstance($event)"
                        (click)="setFocusField('content-email')"
                        class="rounded"
                        [class.has-error]="
                        mailContent.errors &&
                        (mailContent.touched || mailContent.dirty || submitted) &&
                        submitted
                        "
                        #emailEditor
                    >
                    </quill-editor>
                </div>
                <div class="v-center justify-content-end mt-4">
                    <a class="btn f-6 font-weight-bold text-primary px-4 py-2 mr-3" (click)="backUpload()">
                        Back
                    </a>
                    <button class="btn btn-blue f-6 font-weight-bold text-white px-4 py-2" type="submit">
                        Next
                    </button>
                </div>
            </form>
        </div>
        <div class="step-body-3 ml-sm-5" [class.active]="isStep == 3">
            <form 
                #selectThemeForm="ngForm" 
                (ngSubmit)="submitted = true; selectThemeForm.form.valid ? selectTheme() : false"
                [class.was-validated]="submitted"
            >
                <span class="f-4 font-weight-bold text-c-dark">Select material theme</span>
                <div class="row mx-0 mt-3 themes">
                    <div class="col-sm-4 col-6 py-3 theme" *ngFor="let theme of themes" (click)="setVideoTheme(theme)" [class.selected]="selectedTheme.id == theme.id">
                      <img src="{{theme.thumbnail}}" class="w-100 theme-thumb" />
                      <div class="f-1 text-center text-c-dark pt-3 theme-name">{{theme.name}}</div>
                    </div>
                </div>
                <div class="v-center justify-content-end mt-4">
                    <a class="btn f-6 font-weight-bold text-primary px-4 py-2" (click)="backDetail()">
                        Back
                    </a>
                    <button class="btn btn-blue f-6 font-weight-bold text-white px-4 py-2" type="submit">
                        Next
                    </button>
                </div>
            </form>
        </div>
        <div class="step-body-4 ml-sm-5" [class.active]="isStep == 4">
            <form
                #finishUploadForm="ngForm" 
                (ngSubmit)="submitted = true; finishUploadForm.form.valid ? finishUpload() : false"
                [class.was-validated]="submitted"
            >
                <span class="f-4 font-weight-bold text-c-dark">Final Review</span>
                <div class="my-4">
                    <img class="w-100" [src]="video.thumbnail">
                </div>
                <div class="mt-3">
                    <label class="f-1 font-weight-bold text-uppercase small-label">title</label>
                    <span class="v-center f-4 font-weight-bold text-c-dark">{{video.title}}</span>
                </div>
                <div class="mt-3">
                    <label class="f-1 font-weight-bold text-uppercase small-label">DESCRIPTION</label>
                    <span class="v-center f-4 font-weight-bold text-c-dark">{{video.description | stripTags | shorten: 80: '...'}}</span>
                </div>
                <div class="row mt-3">
                    <div class="col-sm-6">
                        <label class="f-1 font-weight-bold text-uppercase small-label">theme</label>
                        <span class="v-center f-4 font-weight-bold text-c-dark">{{selectedTheme.name}}</span>
                        <img class="w-100 mt-2" src="{{selectedTheme.thumbnail}}">
                    </div>
                    <div class="col-sm-6">
                        <label class="f-1 font-weight-bold text-uppercase small-label">preview duration</label>
                        <span class="v-center f-4 font-weight-bold text-c-dark">{{video.duration}} seconds</span>
                        <span class="v-center f-1 small-label mt-2">Chooses default of preview video played while hovering on thumbnail.</span>
                    </div>
                </div>
                <div class="v-center justify-content-end mt-4">
                    <a class="btn f-6 font-weight-bold text-primary px-4 py-2" (click)="backSelectTheme()">
                        Back
                    </a>
                    <button class="btn btn-blue f-6 font-weight-bold text-white px-4 py-2" type="submit">
                        Finish
                    </button>
                </div>
            </form>
        </div>
    </div>
    <ng-container *ngIf="uploading">
        <div class="px-3 pb-3">
            <div class="bg-white rounded">
                <app-loading-overlay [type]="'screen'"></app-loading-overlay>
            </div>
        </div>
    </ng-container>
  </div>