<div class="page-content pt-0">
    <div class="d-flex deal-panel">
        <div class="deal-info-panel pr-3">
            <div class="v-center op-56 c-pointer mb-4 mt-3" (click)="backTasks()">
                <i class="d-block i-icon i-triangle-left bgc-dark mr-2"></i>
                <span class="f-5 font-weight-bold">Back to deals</span>
            </div>
            <div class="v-center justify-content-between deal-main mb-3">
                <div class="f-6 font-weight-bold">
                    {{deal.main.title}}
                </div>
                <div ngbDropdown class="ml-auto button-more p-0">
                    <div class="v-center btn btn-blue" ngbDropdownToggle>
                      <span class="f-6 font-weight-bold text-white c-pointer px-2">
                        Actions
                      </span>
                      <i class="d-block i-icon i-triangle-down bgc-white ml-2"></i>
                    </div>
                    <div ngbDropdownMenu class="light action-menu">
                      <button class="border-0 c-dark dropdown-item" (click)="openAppointmentDlg()">
                        <span class="ml-1 f-3 font-weight-bold">Create appointment</span>
                      </button>
                      <hr class="my-1">
                      <button class="border-0 c-dark dropdown-item" (click)="openEmailDlg()">
                        <span class="ml-1 f-3 font-weight-bold">Send email</span>
                      </button>
                      <hr class="my-1">
                      <button class="border-0 c-dark dropdown-item" (click)="openTaskDlg()">
                        <span class="ml-1 f-3 font-weight-bold">Add task</span>
                      </button>
                      <hr class="my-1">
                      <button class="border-0 c-dark dropdown-item" (click)="openNoteDlg()">
                        <span class="ml-1 f-3 font-weight-bold">Add note</span>
                      </button>
                      <hr class="my-1">
                      <button class="border-0 c-dark dropdown-item" (click)="deleteDealDlg()">
                        <span class="ml-1 f-3 font-weight-bold c-red">Delete deal</span>
                      </button>
                    </div>
                </div>
            </div>
            <div class="deal-stage mb-3">
                <div class="v-center">
                    <div class="f-6 fw-600 op-40 mr-3">
                        Stage
                    </div>
                    <div ngbDropdown>
                        <div class="v-center c-pointer" ngbDropdownToggle>
                            <span class="f-6 px-2 stage-title">
                                {{selectedStage}}
                            </span>
                            <i class="d-block i-icon i-triangle-down bgc-dark ml-2"></i>
                        </div>
                        <div ngbDropdownMenu class="light">
                            <button class="border-0 c-dark dropdown-item" *ngFor="let stage of stages">
                                <span class="ml-1 f-6">{{stage.title}}</span>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="v-center justify-content-between mt-3">
                    <div class="stage-status stage-{{index}} mr-1" *ngFor="let stage of stages; let index=index">
                    </div>
                </div>
            </div>
            <mat-accordion multi class="general-panels">
                <!-- Begin Deal Detail -->
                <mat-expansion-panel class="mat-elevation-z" hideToggle [expanded]="dealPanel">
                    <mat-expansion-panel-header (click)="dealPanel = !dealPanel">
                        <mat-panel-title>
                            <div class="v-center w-100">
                                <i class="i-icon i-triangle-right bgc-dark sm toggle-icon op-40"></i>
                                <span class="f-6 font-weight-bold ml-2">About this deal</span>
                                <button class="btn border-0 border-primary f-2 font-weight-bold c-blue ml-auto btn-sm v-center" (click)="editDeal()">
                                    <i class="i-icon i-edit d-block bgc-blue sm mr-1"></i>
                                    <span>Edit</span>
                                </button>
                            </div>
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <div class="deal-detail">
                        <div class="row">
                            <div class="col-sm-6">
                                <span class="f-6 fw-600 op-40">value</span>
                            </div>
                            <div class="col-sm-6">
                                <span class="f-6">${{deal.main.value}}</span>
                            </div>
                        </div>
                        <div class="row mt-1">
                            <div class="col-sm-6">
                                <span class="f-6 fw-600 op-40">Stage</span>
                            </div>
                            <div class="col-sm-6">
                                <span class="f-6">{{selectedStage}}</span>
                            </div>
                        </div>
                    </div>
                </mat-expansion-panel>
                <!-- End Deal Detail -->

                <!-- Begin Contacts Detail -->
                <mat-expansion-panel class="mat-elevation-z" hideToggle [expanded]="contactsPanel">
                    <mat-expansion-panel-header (click)="contactsPanel = !contactsPanel">
                        <mat-panel-title>
                            <div class="v-center w-100">
                                <i class="i-icon i-triangle-right bgc-dark sm toggle-icon op-40"></i>
                                <span class="f-6 font-weight-bold ml-2">Contacts ({{deal.contacts.length}})</span>
                                <button class="btn border-0 border-primary f-2 font-weight-bold c-blue ml-auto btn-sm v-center" (click)="addContact()">
                                    <i class="i-icon i-plus d-block bgc-blue sm mr-1"></i>
                                    <span>Add contact</span>
                                </button>
                            </div>
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <div class="contact-detail mt-2" *ngFor="let contact of deal.contacts">
                        <div class="contact p-3 position-relative">
                            <div class="v-center py-2 avatar-wrapper">
                                <div class="v-center justify-content-center f-6 font-weight-bold text-white avatar">
                                    {{contact.avatarName}}
                                </div>
                                <div class="f-6 font-weight-bold name">
                                    {{contact.fullName}}
                                </div>
                            </div>
                            <div class="v-center mt-2">
                                <i class="d-block i-icon i-contact-phone bgc-dark mx-2"></i>
                                <span class="f-6">{{contact.cell_phone}}</span>
                            </div>
                            <div class="v-center mt-2">
                                <i class="d-block i-icon i-message bgc-dark mx-2"></i>
                                <span class="f-6">{{contact.email}}</span>
                            </div>
                            <div class="contact-more c-pointer">
                                <i class="d-block i-icon i-menu-more bgc-dark"></i>
                            </div>
                        </div>
                    </div>
                </mat-expansion-panel>
                <!-- End Contacts Detail -->
            </mat-accordion>
        </div>
        <div class="deal-action-panel flex-grow-1 position-relative">
            <div class="history-panel pt-3 pl-3 mt-2">
                <app-slide-tab [tabs]="tabs" [selected]="action" (onChange)="changeTab($event)" type="plain" class="border-bottom pl-0 rounded-0">
                </app-slide-tab>
            </div>
        </div>
    </div>  
</div>