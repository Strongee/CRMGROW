<form
  #eventForm="ngForm"
  (ngSubmit)="submitted = true; eventForm.form.valid ? create() : false"
>
  <div class="overlay-header">
    <div class="form-group mx-2">
      <input
        class="form-control border-primary"
        type="text"
        placeholder="Add appointment title"
        name="title"
        #title="ngModel"
        [(ngModel)]="event.title"
        required
      />
      <span
        class="invalid-error f-3 font-weight-bold c-red"
        *ngIf="event.title == '' && submitted"
      >
        Title is required
      </span>
    </div>
    <div class="row mx-0 date-time">
      <div class="col-12 col-sm-5">
        <div class="form-group">
          <label class="calendar-label">date</label>
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text bgc-blue">
                <i class="i-icon i-calendar bgc-white"></i>
              </span>
            </div>
            <div ngbDropdown>
              <input class="form-control datepicker" placeholder="Select date" name="send_date" [(ngModel)]="selectedDateTime" ngbDropdownToggle type="text" required/>
              <div ngbDropdownMenu class="date-picker">
                <div class="picker-header v-center justify-content-between mt-2">
                  <div class="f-6 font-weight-bold">Appointment date</div>
                  <div class="i-icon i-close bg-dark" ngbDropdownToggle></div>
                </div>
                <hr class="mt-3 mb-1">
                <div class="f-8 c-blue font-weight-bold text-center mt-3">{{ getDateTime() | date : 'MMMM d yyyy' }}</div>
                <div class="picker-body v-center justify-content-between">
                  <div classs="date-picker">
                    <ngb-datepicker name="select_date" #dp [(ngModel)]="due_date" [minDate]="minDate" [firstDayOfWeek]="7" ></ngb-datepicker>
                    <div class="action-button mt-2" align="end">
                      <button class="btn btn-white f-6 font-weight-bold" type="button" ngbDropdownToggle>Cancel</button>
                      <div class="btn btn-primary f-6 font-weight-bold ml-2" (click)="setDateTime()" ngbDropdownToggle>Set</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <span
            class="invalid-error f-3 font-weight-bold c-red"
            *ngIf="due_date.year == '' && due_date.month == '' && due_date.day == '' && submitted"
          >
            Title is required
          </span>
        </div>
      </div>
      <div class="col-12 col-sm-3">
        <div class="form-group">
          <label class="calendar-label">time</label>
          <select
            class="form-control"
            [(ngModel)]="due_time"
            name="time"
            #time="ngModel"
          >
            <option value="" disabled>Due Time</option>
            <option *ngFor="let time of times" value="{{ time.id }}">
              {{ time.text }}
            </option>
          </select>
        </div>
      </div>
      <div class="col-12 col-sm-4">
        <div class="form-group">
          <label class="calendar-label">duration</label>
          <select
            class="form-control"
            [(ngModel)]="duration"
            name="period"
            #period="ngModel"
          >
            <option
              *ngFor="let calendar_duration of calendar_durations"
              value="{{ calendar_duration.value }}"
            >
              {{ calendar_duration.text }}
            </option>
          </select>
        </div>
      </div>
    </div>
    <div class="row mx-0">
      <div class="col-12">
        <div class="form-group">
          <label class="calendar-label">ASSIGN GUESTS</label>
          <app-input-contacts [selectedContacts]="contacts">
          </app-input-contacts>
        </div>
      </div>
    </div>
    <div class="row mx-0">
      <div class="col-12 col-sm-4 form-group">
        <label class="calendar-label">video conference</label>
        <div class="form-group mb-0">
          <button class="btn btn-blue text-white f-6 font-weight-bold w-100">
            Add Zoom Link
          </button>
        </div>
      </div>
      <div class="col-12 col-sm-8 form-group">
        <label class="calendar-label">location</label>
        <div class="form-group mb-0">
          <input
            class="form-control"
            placeholder="Add location"
            [(ngModel)]="event.location"
            name="address"
            #address="ngModel"
            ngx-google-places-autocomplete
            #addressplacesRef="ngx-places"
            [options]="{
              types: [],
              componentRestrictions: { country: 'US' }
            }"
            (onAddressChange)="handleAddressChange($event)"
          />
        </div>
      </div>
    </div>
    <div class="row mx-0">
      <div class="col-12 form-group mb-0">
        <label class="calendar-label">DESCRIPTION</label>
        <app-html-editor
          [(value)]="event.description"
          placeholder="Add description"
          required="true"
          [style]="{height: '90px'}"
          (onFocus)="focusEditor()"
          #emailEditor
          >
        </app-html-editor>
      </div>
    </div>
    <div class="row mx-0">
      <div class="col-12 v-center justify-content-between">
        <div class="custom-control custom-checkbox my-auto">
          <input
            type="checkbox"
            class="custom-control-input"
            id="customControlInline"
            [checked]="isRepeat"
            (change)="setRepeatEvent()"
          />
          <label
            class="custom-control-label f-3 font-weight-bold pt-1"
            for="customControlInline"
            >Set as recurring event</label
          >
        </div>
        <div class="form-group mt-3 ml-3">
          <select
            class="form-control text-primary"
            [(ngModel)]="event.recurrence"
            name="repeat"
            #repeat="ngModel"
            [disabled]="!isRepeat"
          >
            <option
              *ngFor="let recurring of recurrings"
              value="{{ recurring.value }}"
            >
              {{ recurring.text }}
            </option>
          </select>
        </div>
      </div>
    </div>
  </div>
  <div class="overlay-footer py-3" align="end">
    <div class="row mx-0">
      <div class="col-12">
        <button
          type="button"
          (click)="overlayClose()"
          class="btn btn-white mr-2 py-2 f-6 font-weight-bold"
        >
          Cancel
        </button>
        <button
          type="submit"
          class="btn btn-blue text-white br-default mr-2 py-2 f-6 font-weight-bold"
          [class.loading]="isLoading"
        >
          Create
        </button>
      </div>
    </div>
  </div>
</form>
